---
title: "p8105_hw3_sal2222"
author: "Stephen Lewandowski"
date: "October 15, 2018"
output: html_document
---


```{r setup, include = FALSE}

library(tidyverse)
library(readxl)
library(devtools)
library(p8105.datasets) #devtools::install_github("p8105/p8105.datasets")

knitr::opts_chunk$set(
  fig.width = 6,
  fig.asp = .6,
  out.width = "90%"
)

theme_set(theme_bw() + theme(legend.position = "bottom"))
```

# Problem 1


I will load and format the Behavioral Risk Factors Surveillance System (BRFSS) for Selected Metropolitan Area Risk Trends (SMART) data from the p8105.datasets package.

```{r load BRFSS}

data("brfss_smart2010")
brfss <- brfss_smart2010 %>% 
  janitor::clean_names() %>%
  filter(topic == "Overall Health") %>%
  select(-c(class, topic, question, sample_size, confidence_limit_low:geo_location)) %>% 
  spread(key = response, value = data_value) %>% 
  janitor::clean_names() %>% 
  rename(state = locationabbr, county = locationdesc) %>% 
  separate(county, into = c("remove", "county"), sep = "- ") %>%
  select(year, state, county, poor, fair, good, very_good, excellent)
  
brfss
   
```


I will answer questions using this BRFSS dataset.

*In 2002, which states were observed at 7 locations?*

```{r brfss states with 7 locations}

brfss %>% 
  filter(year == 2002) %>% 
  group_by(state) %>% 
  summarise(number = n()) %>% 
  filter(number == 7)

```

In 2002, 7 locations were observed in *Connecticut, Florida, and North Carolina*.  



*Make a “spaghetti plot” that shows the number of observations in each state from 2002 to 2010.*

```{r spaghetti plot}
brfss %>% 
  group_by(state, year) %>% 
  summarise(number = n()) %>% 
  ggplot(aes(x = year, y = number, group = state, color = state)) +
    geom_line() +
    labs(
      title = "Locations observed by state, 2002-2010",
      x = "Year",
      y = "Number of observations",
      caption = "Data from BRFSS SMART 2010"
    ) +
    viridis::scale_color_viridis(
      name = "State", 
    discrete = TRUE
    ) +
    theme(legend.position = "none")
```

This plot is useful for showing the general trend of locations by state from 2002 to 2010. However, it is very difficult to identify individual states, and a legend occupies too much space, if included.


*Make a table showing, for the years 2002, 2006, and 2010, the mean and standard deviation of the proportion of “Excellent” responses across locations in NY State.*




*For each year and state, compute the average proportion in each response category (taking the average across locations in a state). Make a five-panel plot that shows, for each response category separately, the distribution of these state-level averages over time*



#Problem 2







#Problem 3